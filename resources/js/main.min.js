var hashHistory=["step-1"],windowBack=!0;$(document).ready(function(){function a(a,e,t){$(a).each(function(a){$(this).on(t,function(){var t=$(this).val();"on"==$(".btn-form-mirror").data("toggle-mirror")&&$(e+":eq("+a+")").val(t)})})}function e(){$("#billing-info [data-mirror]").each(function(a){var e=$(this).val();$("#shipping-info [data-mirror]:eq("+a+")").val(e)}),$("#shipping_country[data-mirror]").trigger("change")}$(".dropdown-text").click(function(){$(".dropdown-content").toggleClass("dropdown-show")}),$(".dropdown-text").on("tap",function(){$(".dropdown-content").toggleClass("dropdown-show")}),$("#checkout-page").on("click",".data-ajax-url",function(a){windowBack=!1,window.location.hash=$(this).attr("data-hash"),a.preventDefault(),hashHistory.push($(this).attr("data-hash")),console.log(hashHistory),setTimeout(function(){windowBack=!0},100)}),$(window).on("hashchange",window,function(){"step-1"==hashHistory[hashHistory.length-2]&&1==windowBack?($(document).sendRequest("shop:checkout",{update:{"#checkout-page":"shop-checkout"},extraFields:{nextStep:"billing_info"}}),hashHistory.splice(-2),hashHistory.push("step-1")):"step-2"==hashHistory[hashHistory.length-2]&&1==windowBack?($(document).sendRequest("shop:checkout",{update:{"#checkout-page":"shop-checkout"},extraFields:{nextStep:"shipping_method"}}),hashHistory.splice(-2),hashHistory.push("step-2")):"step-3"==hashHistory[hashHistory.length-2]&&1==windowBack&&($(document).sendRequest("shop:checkout",{update:{"#checkout-page":"shop-checkout"},extraFields:{nextStep:"pay"}}),hashHistory.splice(-2),hashHistory.push("step-3"))}),$(document).on("change","#payment_method input",function(){$("#payment_form").html('<i class="fa fa-refresh fa-spin"/>'),$(this).sendRequest("shop:onUpdatePaymentMethod",{update:{"#payment_form":"shop-paymentform"}})}),$(document).on("change","#shipping-methods input",function(){$(this).sendRequest("shop:onUpdateShippingMethod",{update:{"#shop-cart":"shop-checkout-totals"}})}),$(document).on("click",".btn-form-mirror",function(){"on"==$(this).data("toggle-mirror")?($(this).data("toggle-mirror","off").find(".fa-check").css("visibility","hidden"),sessionStorage.toggleMirror="off",$("#shipping-info").each(function(a,e){$(e).find("input, select").each(function(a,e){$(e).removeClass("disabled")})})):"off"==$(this).data("toggle-mirror")&&($(this).data("toggle-mirror","on").find(".fa").css("visibility","visible"),sessionStorage.toggleMirror="on",e(),$("#shipping-info").each(function(a,e){$(e).find("input, select").each(function(a,e){$(e).addClass("disabled")})}))}),$(window).on("onAjaxAfterUpdate",function(){$(".btn-form-mirror").length&&"off"==sessionStorage.toggleMirror&&($(".btn-form-mirror").data("toggle-mirror","off").find(".fa").css("visibility","hidden"),$("#shipping-info").addClass("in"))}),a("#billing-info [data-mirror]","#shipping-info [data-mirror]","keyup keypress blur change"),$(window).load(function(){"on"==$(".btn-form-mirror").data("toggle-mirror")&&e()});var t=!1;$("#billing_country[data-mirror]").on("change",function(){"on"==$(".btn-form-mirror").data("toggle-mirror")&&(t=!0)}),$(window).on("onAfterAjaxUpdate",function(){1==t&&($("#shipping_country[data-mirror]").change(),console.log("ajax done"),t=!1),$("#shipping_state[data-mirror]").val()!=$("#billing_state[data-mirror]").val()&&$("#shipping_state[data-mirror]").val($("#billing_state[data-mirror]").val())}),window.innerWidth<991&&($("#checkout-page #shipping-info").hide(),$(".btn-form-mirror").on("click",function(){"off"==$(".btn-form-mirror").data("toggle-mirror")?$("#shipping-info").hide():"on"==$(".btn-form-mirror").data("toggle-mirror")&&$("#shipping-info").show()})),$(document).on("click","#search-item",function(){$(".search-bar").toggleClass("active-search")}),$(document).on("click","#normal-carts",function(){$(".search-bar").hasClass("active-search")&&$(".search-bar").removeClass("active-search")});var o=new $.Deferred;$(document).on("click",".btn-add-cart",function(){o.resolve(),$(this).prepend('<i class="fa fa-refresh fa-spin"/>')}),$(document).ajaxComplete(function(){$(".btn-add-cart").find(".fa-refresh").remove(),$.when(o).then(function(){$("#normal-cart").addClass("added"),setTimeout(function(){$("#normal-cart").removeClass("added"),o=new $.Deferred},500)})}),$("body").on("click",".remove-item",function(){o.resolve(),$(this).find(".fa").removeClass("fa-times").addClass("fa-refresh fa-spin")}),$("body").on("click","#remove-cart-item",function(){o.resolve(),$(this).find(".fa").removeClass("fa-times").addClass("fa-refresh fa-spin")}),$(document).ajaxComplete(function(){$(".credit-card-input").length&&($(".credit-card-input").validateCreditCard(function(a){a.length_valid===!0?$(".credit-card-input").next("label").html(a.card_type.name).append(' <i class="fa fa-check-circle" />').parent().removeClass("invalid").addClass("valid"):$(".credit-card-input").keyup(function(){var a=$(".credit-card-input").val(),e=a.substr(0,4);switch(e){case"":$(".credit-card-input").addClass("defaultPosition").removeClass("va ma mb d a");break;case"4":$(".credit-card-input").addClass("va").removeClass("ma mb d a");break;case"3":$(".credit-card-input").addClass("a").removeClass("ma mb d va");break;case"51":case"52":case"53":case"54":case"55":$(".credit-card-input").addClass("ma").removeClass("va mb d a");break;case"5018":case"5020":case"5038":case"6304":case"6759":case"6761":case"6762":case"6763":$(".credit-card-input").addClass("mb").removeClass("va ma d a");break;case"6":$(".credit-card-input").addClass("d").removeClass("va ma mb a")}}).keyup}),""===$(".credit-card-input").val()&&$(".credit-card-input").parent().removeClass("valid invalid"));var a="<img src='//d1ikx7rs2s8wko.cloudfront.net/store-slate-543ef23235dfb/themes/asdfasdf/resources/img/cvn.jpg?1424897548' style='width:100px'>",e="</br>";$(".fa-question").popover({trigger:"hover",placement:top,html:!0,content:"For MasterCard, Visa, and Discover, the CSC is the last three digits in the signature area on the back of your card. For American Express, it's the four digits on the front of the card."+e+e+a})})});